---
layout: post
title: optimizing example
date: '2010-10-12T17:10:00.001-07:00'
author: Daniel Hilst
blogger: true
tags: 
modified_time: '2010-10-12T21:25:01.792-07:00'
blogger_id: tag:blogger.com,1999:blog-8785437776394405849.post-1059316468104793002
blogger_orig_url: http://gkos-hw.blogspot.com/2010/10/test.html
---

<pre class="brush: as">/*<br /> * #include &lt;stdio.h&gt;<br /> * <br /> * int<br /> * main (void)<br /> * {<br /> *     int i;    <br /> *     for (i = 0; i &lt; 10; i++)<br /> *         printf ("%d ", i);<br /> *     return 0;<br /> * }<br /> */<br />    .file    "ex.c"<br />    .section    .rodata<br />.LC0:<br />    .string    "%d "<br />    .text<br />.globl main<br />    .type    main, @function<br />main:<br />    pushl    %ebp<br />    movl    %esp, %ebp<br />    andl    $-16, %esp<br />    subl    $32, %esp<br />    movl    $0, 28(%esp)<br />    jmp    .L2<br />.L3:<br />    movl    $.LC0, %eax<br />    movl    28(%esp), %edx<br />    movl    %edx, 4(%esp)<br />    movl    %eax, (%esp)<br />    call    printf<br />    addl    $1, 28(%esp)<br />.L2:<br />    cmpl    $9, 28(%esp)<br />    jle    .L3<br />    movl    $0, %eax<br />    leave<br />    ret<br />    .size    main, .-main<br />    .ident    "GCC: (GNU) 4.5.1"<br />    .section    .note.GNU-stack,"",@progbits<br /><br /></pre><pre class="brush: as">.file    "ex.c"<br />    .section    .rodata<br />.LC0:<br />    .string    "%d "<br />    .text<br />.globl main<br />    .type    main, @function<br />main:<br />    pushl    %ebp<br />    movl    %esp, %ebp<br />    andl    $-16, %esp<br />    subl    $32, %esp<br />    movl    $0, 4(%esp)<br />    jmp    .L2<br />.L3:<br />    movl    $.LC0, %eax<br />    movl    %eax, (%esp)<br />    call    printf<br />    incl    4(%esp)<br />.L2:<br />    cmpl    $9, 4(%esp)<br />    jle    .L3<br />    movl    $0, %eax<br />    leave<br />    ret<br />    .size    main, .-main<br />    .ident    "GCC: (GNU) 4.5.1"<br />    .section    .note.GNU-stack,"",@progbits<br /></pre>The first file has as comment the c program that generates it.<br />The second one is the same, but with some modifications that I made..<br />reducing the number of instructions and replacing an add<br />with an inc intruction. Assembly world is really fun!!<br /><br />Oh yes.. I extend SH to get a poorly gas syntaxhighlighter (:<br />I guess this is my first real work with free community!!<br />here is the post announcement: <a href="http://alexgorbatchev.com/forums/viewtopic.php?f=2&amp;t=77">http://alexgorbatchev.com/forums/viewtopic.php?f=2&amp;t=77</a> and<br />here is the project page <a href="http://github.com/gkos/gas-brush">http://github.com/gkos/gas-brush</a><br />I'm felling really happy with this!! Maybe tomorrow I speak about downseq project (:<br /><br />Cheers!