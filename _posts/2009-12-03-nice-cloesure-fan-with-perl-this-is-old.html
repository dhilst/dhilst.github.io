---
layout: post
title: Nice cloesure fun with perl... this is old (sep 25)
date: '2009-12-03T23:33:00.000-08:00'
author: Daniel Hilst
tags: 
modified_time: '2009-12-04T09:21:13.085-08:00'
blogger_id: tag:blogger.com,1999:blog-8785437776394405849.post-4135162221573421367
blogger_orig_url: http://gkos-hw.blogspot.com/2009/12/nice-cloesure-fan-with-perl-this-is-old.html
---

<pre class="brush: perl"># use:<br /># my $date = date(startday, startmonth);<br /># print &$date;   # print and increase current date<br /># print &$date(1) # print but doesn't increase current date<br />#<br /># Behavior:<br /># every time that the $date is dereferenced,<br /># it increase the date in your inner code<br /># and return it, unless it called with a <br /># bollean true argument; like 1. <br /><br />package Date;<br /><br />sub chk {<br />    # return 1 if the item is found in list<br />    # arguments need be a reference or <br />    # be passed as a refenrece<br />    my ($it, $lst) = @_; # (item, list)<br />    map  {<br />        return 1 if $_ == $$it;<br />    } @$lst;<br />    return 0;<br />}<br /><br />sub date { <br />    # $date = &date(startday, startmonth)<br />    # return a cloesure that return and <br />    # increase the current date <br />    # or not <br />    my ($day, $mon) = (1,month(1)); # default;<br />       ($day, $mon) = ($_[0], month($_[1])) if @_; # get the <br />                                                   # start <br />                                                   # day/month<br />    return sub { <br />        # &$date() or &$date(1);<br /> if ($day > lastday(&$mon(1))) {<br />            $day = 1; # lastday + 1 eq day first<br />            &$mon;    # increase the month<br />        }<br />        return ($day++, &$mon(1)) unless @_; # return in list<br />        return ($day,   &$mon(1));           # return but does't <br />                                             # increase<br />    };<br />}<br /><br />sub lastday { <br />    # last(&$mon(1))<br />    # return the last properly day in current month<br />    my ($mon) = @_;     # take de current month<br />    return 28 if $mon == 2;    # february<br />    return 30 if chk(\$mon, [4,6,9,11]); # april.. november<br />    return 31;      # others<br />}<br /><br />sub month { <br />    # $mon = month(number)<br />    # return and increase the current month<br />    my $month = shift;<br />    return sub { <br />        # &$month(1) or $month<br />        $month = 1 if $month == 13;<br />        return $month++ unless @_; # return it and increase<br /> return $month;             # return it and doesn't <br />                                   # increase<br />    };<br />}<br /><br />#little test<br />my $date = date();<br />for my $num (1 .. 365) {<br />    printf ("%2d/%2d\n", &$date);<br />}<br /></pre><br />cloesures are nice...<br /><br />So.. here I have a function that return another funtion, i.e., a cloesure<br />to be brief.. cloesures closes code in its self<br />so I have a $date variable that is a reference(the pointer name in perl) to a function<br />and every time that I cancel this reference(like * does in C), the date (inside the variable) increase one day. I can have how much indepent dates I want. i.e<br />cloesure closes code... every date variable have a date value close inside of it